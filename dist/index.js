function Pe(){console.log("üìç A≈æuriranje navigacije s trenutaƒçnim href-om");const e=document.querySelectorAll(".nav-link"),t=window.location.pathname;console.log(`üîç Trenutni URL path: ${t}`),e.forEach(r=>{const n=r.getAttribute("href");console.log(`üìå Provjeravam link: ${n}`),t===n||t==="/"&&n==="/"?(console.log(`‚úÖ Link postavljen kao aktivan: ${n}`),r.setAttribute("aria-current","page"),r.classList.add("current","w--current")):(r.removeAttribute("aria-current"),r.classList.remove("current","w--current"))}),console.log("‚úÖ Navigacija uspje≈°no a≈æurirana")}function Ae(e){switch(console.log(`üèóÔ∏è Inicijalizacija specifiƒçnih funkcija za stranicu: ${e}`),e){case"home":console.log("üè† Uƒçitavanje HOME komponenti:"),console.log("  - Inicijalizacija Hero sekcije"),initHero==null||initHero(),console.log("  - Inicijalizacija About sekcije"),initAboutSection==null||initAboutSection(),console.log("  - Inicijalizacija Highlights sekcije"),initHighlights==null||initHighlights(),console.log("  - Inicijalizacija Categories sekcije"),initCategories==null||initCategories();break;case"work":case"work-abstract":case"work-nature":case"work-people":case"work-products":case"work-architecture":console.log("üíº Uƒçitavanje WORK komponenti:"),console.log("  - Inicijalizacija Work sekcije"),initWork==null||initWork(),console.log("  - Inicijalizacija animacije naslova kategorije"),initCategoryTitleAnimation==null||initCategoryTitleAnimation(),console.log("  - Inicijalizacija Photo modala"),initPhotoModal==null||initPhotoModal();break;case"about":console.log("üë§ Uƒçitavanje ABOUT komponenti:"),console.log("  - Inicijalizacija About sekcije"),console.log("üîç DEBUG: typeof initAbout =",typeof initAbout),console.log("üîç DEBUG: window.initAbout =",window.initAbout),console.log("üîç DEBUG: Pozivam initAbout?.()..."),initAbout==null||initAbout(),console.log("üîç DEBUG: initAbout?.() zavr≈°en");break;default:console.log(`‚ö†Ô∏è Nepoznati namespace: ${e}, ne inicijaliziram specifiƒçne funkcije`)}console.log(`‚úÖ Inicijalizacija stranice ${e} zavr≈°ena`)}function Ce(){console.log("üîÑ Zapoƒçinjem inicijalizaciju Barba.js"),console.log("üìã Postavljam history.scrollRestoration na 'manual'"),"scrollRestoration"in history&&(history.scrollRestoration="manual"),console.log("‚öôÔ∏è Konfiguriram Barba.js tranzicije i namespace-ove"),barba.hooks.beforeEnter(()=>{console.log("üåì [Global Hook] Primjena Dark Mode prije svake tranzicije"),localStorage.getItem("dark-mode")==="enabled"?(document.documentElement.classList.add("ui-dark-mode"),document.body.classList.add("ui-dark-mode")):(document.documentElement.classList.remove("ui-dark-mode"),document.body.classList.remove("ui-dark-mode"))}),barba.init({transitions:[{name:"fade",leave(e){return console.log(`üö™ LEAVE: Napu≈°tam stranicu ${e.current.namespace}`),console.log(`  - URL: ${e.current.url.path}`),window.lenis&&window.lenis.stop(),console.log("üßπ ƒåi≈°ƒáenje ScrollTrigger instanci"),ScrollTrigger.getAll().forEach(t=>{t.kill()}),console.log("üåì Odr≈æavam Dark Mode postavke tijekom izlazne tranzicije"),localStorage.getItem("dark-mode")==="enabled"&&(document.documentElement.classList.add("ui-dark-mode"),document.body.classList.add("ui-dark-mode")),console.log("  - Primjenjujem izlaznu animaciju (opacity: 0)"),gsap.to(e.current.container,{opacity:0,duration:.3})},beforeEnter(e){console.log(`üîë BEFORE ENTER: Pripremam ulazak na stranicu ${e.next.namespace}`),console.log(`  - URL: ${e.next.url.path}`),console.log("üåì Primjena Dark Mode postavki iz localStorage-a (PRIJE prikaza)"),localStorage.getItem("dark-mode")==="enabled"?(console.log("  - Dark Mode aktivan - dodajem ui-dark-mode klasu na html i body"),document.documentElement.classList.add("ui-dark-mode"),document.body.classList.add("ui-dark-mode")):(console.log("  - Dark Mode neaktivan - uklanjam ui-dark-mode klasu"),document.documentElement.classList.remove("ui-dark-mode"),document.body.classList.remove("ui-dark-mode")),window.lenis?window.lenis.scrollTo(0,{immediate:!0,force:!0}):window.scrollTo(0,0)},enter(e){return console.log(`üö™ ENTER: Ulazim na stranicu ${e.next.namespace}`),console.log(`  - URL: ${e.next.url.path}`),console.log("  - Primjenjujem ulaznu animaciju (opacity: 1)"),gsap.to(e.next.container,{opacity:1,duration:.3})},after(e){console.log(`üé≠ AFTER: Tranzicija na ${e.next.namespace} zavr≈°ena`),console.log(`  - Pozivam inicijalizaciju specifiƒçnih funkcija za ${e.next.namespace}`),Ae(e.next.namespace),console.log("  - A≈æuriram status navigacije"),Pe(),requestAnimationFrame(()=>{window.lenis&&window.lenis.start(),ScrollTrigger.refresh(!0)})}}],views:[{namespace:"home"},{namespace:"work"},{namespace:"about"},{namespace:"work-abstract"},{namespace:"work-nature"},{namespace:"work-people"},{namespace:"work-products"},{namespace:"work-architecture"}]}),console.log("‚úÖ Barba.js uspje≈°no inicijaliziran")}window.addEventListener("beforeunload",()=>{console.log("üîÑ beforeunload: Resetiram scroll prije napu≈°tanja stranice"),window.scrollTo(0,0)});console.log("üöÄ Pokreƒáem Barba.js inicijalizaciju");Ce();console.log("‚úÖ Barba.js konfiguracija kompletna");function ce(){const e=new Lenis({lerp:.1,wheelMultiplier:1,smoothWheel:!0,smoothTouch:!1,infinite:!1});window.lenis=e,e.on("scroll",ScrollTrigger.update),gsap.ticker.add(t=>{e.raf(t*1e3)}),gsap.ticker.lagSmoothing(0)}window.initLenis=ce;ce();function de(){const e=document.body,t=document.querySelector(".nav-theme-switcher");localStorage.getItem("dark-mode")==="enabled"?(document.documentElement.classList.add("ui-dark-mode"),e.classList.add("ui-dark-mode")):(document.documentElement.classList.remove("ui-dark-mode"),e.classList.remove("ui-dark-mode")),t&&t.addEventListener("click",()=>{e.classList.contains("ui-dark-mode")?(document.documentElement.classList.remove("ui-dark-mode"),e.classList.remove("ui-dark-mode"),console.log("Removed .ui-dark-mode from html and body"),localStorage.setItem("dark-mode","disabled")):(document.documentElement.classList.add("ui-dark-mode"),e.classList.add("ui-dark-mode"),console.log("Added .ui-dark-mode to html and body"),localStorage.setItem("dark-mode","enabled"))})}window.initDarkMode=de;de();function ue(){const e=document.querySelector(".section.footer"),t=e==null?void 0:e.previousElementSibling;gsap.registerPlugin(ScrollTrigger),t&&(gsap.to(t,{scrollTrigger:{trigger:t,start:"top top",end:()=>`+=${window.innerHeight*.5}`,pin:!1,scrub:!0,id:"footer-prev-section"}}),gsap.to(e,{scrollTrigger:{trigger:t,start:()=>`bottom+=${window.innerHeight*.5} bottom`,end:"bottom bottom",scrub:!0,id:"footer-main"}}),gsap.set(t,{zIndex:1}))}window.initFooter=ue;ue();function me(e,t=!0){e.dataset.originalText||(e.dataset.originalText=e.textContent);const r=e.dataset.originalText;e.style.position="relative",e.style.zIndex="100000";let n;e.querySelector(".shuffle-text")?n=e.querySelector(".shuffle-text"):(n=document.createElement("span"),n.className="shuffle-text",n.textContent=r,e.textContent="",e.appendChild(n)),n.style.pointerEvents="none";let i=!1,s;const u=h=>{const a=h.split("");for(let S=a.length-1;S>0;S--){const L=Math.floor(Math.random()*(S+1));[a[S],a[L]]=[a[L],a[S]]}return a.join("")},y=()=>{s&&(clearInterval(s),s=null),n.textContent=r,i=!1},m=()=>{if("ontouchstart"in window||navigator.maxTouchPoints>0||i)return;i=!0;let h=0;s&&clearInterval(s),s=setInterval(()=>{h<3?(n.textContent=u(r),h++):(n.textContent=r,clearInterval(s),s=null,i=!1)},100)};return t&&("ontouchstart"in window||navigator.maxTouchPoints>0||e.addEventListener("mouseenter",m),e.addEventListener("click",function(a){y()})),m}function ge(){document.querySelectorAll(".link, .cta").forEach(e=>{me(e,!0)})}window.createShuffleEffect=me;window.initLinksHover=ge;ge();function pe(){const e=window.navigator.userAgent,t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),r=!!e.match(/WebKit/i);return t&&r&&!e.match(/CriOS/i)&&!e.match(/FxiOS/i)}function ze(){if(!pe())return;document.body.addEventListener("click",function(n){const i=n.target.closest("a, button");i&&(i.style.transition="opacity 0.2s ease-out",i.style.opacity="0.5",setTimeout(()=>{i.style.opacity="1"},300))});function e(n){var i=n.tagName.toLowerCase(),s=n.dataset.bind,u=s&&s.indexOf("click")>-1||i=="a"||i=="button";return u}var t={touchend:function(n,i){i.dataset._clicked_="",i.dataset._mousemove_="0",i.dataset._timeOutId_=""},mouseover:function(n){n.preventDefault()},mousemove:function(n,i){n.preventDefault();var s=+(i.dataset._mousemove_||"0");if(s=s+1,console.log("mousemoves: "+s),i.dataset._mousemove_=s,s>1&&!i.dataset._timeOutId_){var u=setTimeout(function(){console.log("double mousemove click fired"),i.click()},80);i.dataset._timeOutId_=u}},click:function(n,i){if(i.dataset._clicked_){n.isTrusted&&(console.log("prevented doubleclick"),n.preventDefault());return}i.dataset._timeOutId_&&(console.log("cleared timeout"),clearTimeout(+i.dataset._timeOutId_)),i.dataset._clicked_="true"}};function r(n){var i=n.target;if(i&&i.click&&i.tagName&&i.dataset&&e(i)){var s=n.type;console.log(s,i),t[s]&&t[s](n,i)}}document.addEventListener("touchend",r,!0),document.addEventListener("mouseover",r,!0),document.addEventListener("mousemove",r,!0),document.addEventListener("click",r,!0)}function fe(){pe()&&ze()}window.initIosSafariFix=fe;fe();const $={enabled:!1,logs:[],lastScrollY:0,lastTimestamp:0,freezeThreshold:100,init(){this.enabled&&(console.log("üîç ScrollDebugger aktiviran"),window.lenis&&window.lenis.on("scroll",e=>{this.logScroll("LENIS",e)}),window.ScrollTrigger&&(ScrollTrigger.addEventListener("refresh",()=>{console.log("üîÑ ScrollTrigger REFRESH event")}),ScrollTrigger.addEventListener("scrollStart",()=>{console.log("‚ñ∂Ô∏è ScrollTrigger SCROLL START")}),ScrollTrigger.addEventListener("scrollEnd",()=>{console.log("‚è∏Ô∏è ScrollTrigger SCROLL END")})),this.startRAFMonitoring(),this.trackScrollDirection(),console.log("‚úÖ ScrollDebugger setup complete"))},logScroll(e,t){var u;const r=performance.now(),n=r-this.lastTimestamp,i=t.scroll-this.lastScrollY,s=i>0?"‚¨áÔ∏è DOWN":"‚¨ÜÔ∏è UP";n>this.freezeThreshold&&this.lastTimestamp>0&&console.warn(`üö® FREEZE DETECTED! ${n.toFixed(2)}ms gap`,{scrollPosition:t.scroll,direction:s,gap:`${n.toFixed(2)}ms`,scrollDelta:i}),Math.abs(i)>1&&console.log(`üìú ${e} ${s}`,{scroll:t.scroll.toFixed(2),velocity:((u=t.velocity)==null?void 0:u.toFixed(2))||"N/A",delta:i.toFixed(2),time:n.toFixed(2)+"ms"}),this.lastScrollY=t.scroll,this.lastTimestamp=r},startRAFMonitoring(){let e=performance.now(),t=0;const r=n=>{var s;const i=n-e;i>32&&console.warn(`‚è±Ô∏è SLOW FRAME: ${i.toFixed(2)}ms (${(1e3/i).toFixed(1)}fps)`,{framesSinceLastLog:t,scrollY:((s=window.lenis)==null?void 0:s.scroll)||window.scrollY}),t++,e=n,requestAnimationFrame(r)};requestAnimationFrame(r)},trackScrollDirection(){let e=null;const t=()=>{var i;const r=((i=window.lenis)==null?void 0:i.scroll)||window.scrollY,n=r>this.lastScrollY?"down":"up";n!==e&&e!==null&&console.log(`üîÑ DIRECTION CHANGE: ${e} ‚Üí ${n}`,{scrollY:r.toFixed(2),activeScrollTriggers:ScrollTrigger.getAll().length}),e=n,requestAnimationFrame(t)};requestAnimationFrame(t)},logScrollTriggers(){const e=ScrollTrigger.getAll();console.log(`üìä Active ScrollTriggers: ${e.length}`),e.forEach(t=>{console.log(`  - ${t.vars.id||"unnamed"}`,{start:t.start,end:t.end,progress:t.progress.toFixed(2),isActive:t.isActive})})}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>$.init()):$.init();window.ScrollDebugger=$;document.addEventListener("keydown",e=>{var t,r,n;(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="D"&&(console.log("üîç === SCROLL DEBUG DUMP ==="),$.logScrollTriggers(),console.log("Lenis state:",{scroll:(t=window.lenis)==null?void 0:t.scroll,velocity:(r=window.lenis)==null?void 0:r.velocity,direction:(n=window.lenis)==null?void 0:n.direction}),console.log("========================="))});function Re(){if("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0){console.log("üñ±Ô∏è Touch device detektiran - custom cursor onemoguƒáen");return}const t=document.createElement("div");t.id="custom-cursor",t.style.cssText=`
    position: fixed;
    width: 56px;
    height: 32px;
    border-radius: 999px;
    pointer-events: none;
    z-index: 9999;
    transform: translate(-50%, -50%);
    transition: opacity 0.2s ease;
    background-color: #ffffff;
    mix-blend-mode: difference;
    opacity: 0;
    display: none;
  `,document.body.appendChild(t);let r=window.innerWidth/2,n=window.innerHeight/2;const i=m=>{r=m.clientX,n=m.clientY,t.style.left=`${r}px`,t.style.top=`${n}px`},s=()=>{t.style.display="block",setTimeout(()=>{t.style.opacity="1"},10)},u=()=>{t.style.opacity="0",setTimeout(()=>{t.style.display="none"},200)};window.addEventListener("hero:drag:start",s),window.addEventListener("hero:drag:end",u);const y=m=>{i(m)};return window.addEventListener("mousemove",y),()=>{t.remove(),window.removeEventListener("mousemove",y),window.removeEventListener("hero:drag:start",s),window.removeEventListener("hero:drag:end",u)}}function he(){console.log("üé® HERO.JS ENABLED - testiranje sa optimizacijama");const e=document.querySelector(".section.hero"),t=document.querySelector(".hero-title"),r=document.querySelectorAll(".hero-footer");if(!e){console.error("‚ùå Hero sekcija nije pronaƒëena!");return}r.forEach(c=>{c.style.position="relative",c.style.zIndex="10",c.style.pointerEvents="auto",c.querySelectorAll('a, button, [role="button"]').forEach(j=>{j.style.position="relative",j.style.zIndex="11",j.style.pointerEvents="auto"})});const n=document.querySelector(".hero-images-wrapper");if(!n){console.warn("Hero wrapper nije pronaƒëen!");return}const i=Array.from(document.querySelectorAll(".hero-image")),s=i.length;if(console.log(`‚úÖ Pronaƒëeno ${s} slika u CMS-u (bez duplikata)`),s===0){console.warn("‚ö†Ô∏è Nema slika za prikaz!");return}const u=document.querySelector(".hero-images-container");if(typeof THREE>"u"){console.error("‚ùå Three.js nije uƒçitan! Provjerite Webflow Footer Code.");return}console.log("üé® Pokreƒáem 3D Cylinder Carousel..."),i.forEach(c=>{c.style.display="none"}),n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.pointerEvents="auto",u.innerHTML="",u.style.position="relative",u.style.width="100%",u.style.height="100%",u.style.overflow="hidden",u.style.pointerEvents="auto";const y=new THREE.Scene,m=new THREE.PerspectiveCamera(40,u.offsetWidth/u.offsetHeight,.1,3e3);m.position.z=900;const h=window.innerWidth<=768;m.position.y=h?-50:0;const a=new THREE.WebGLRenderer({alpha:!0,antialias:!0});a.setSize(u.offsetWidth,u.offsetHeight),a.setPixelRatio(Math.min(window.devicePixelRatio,2)),a.setClearColor(0,0),a.domElement.style.position="absolute",a.domElement.style.top="0",a.domElement.style.left="0",a.domElement.style.width="100%",a.domElement.style.height="100%",a.domElement.style.zIndex="1",u.appendChild(a.domElement),console.log("üé® Canvas kreiran i dodan - pointer events OMOGUƒÜENI!");const S=new THREE.AmbientLight(16777215,.6);y.add(S);const L=new THREE.DirectionalLight(16777215,.4);L.position.set(0,500,800),y.add(L);const A=`
    uniform float uBend;
    varying vec2 vUv;
    varying float vBendAmount;

    void main() {
      vUv = uv;
      vec3 pos = position;
      
      // Cylinder bend - zakrivljenje po X-osi
      float bend = pos.x * pos.x * uBend;
      pos.z -= bend;
      
      // ≈†alji bend amount u fragment shader za lighting
      vBendAmount = bend;
      
      gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
    }
  `,x=`
    uniform sampler2D uTexture;
    uniform float uOpacity;
    varying vec2 vUv;
    varying float vBendAmount;

    void main() {
      vec4 texColor = texture2D(uTexture, vUv);
      
      // Shadow na rubovima za nagla≈°avanje benda
      float edgeShadow = 1.0 - smoothstep(0.5, 1.0, abs(vUv.x - 0.5) * 2.0) * 0.25;
      
      // Vignette za dubinu
      vec2 center = vUv - 0.5;
      float vignette = 1.0 - smoothstep(0.3, 0.8, length(center)) * 0.1;
      
      vec3 finalColor = texColor.rgb * edgeShadow * vignette;
      
      gl_FragColor = vec4(finalColor, texColor.a * uOpacity);
    }
  `,T=new THREE.TextureLoader,b=[],p=new THREE.Group;y.add(p);const P=Math.random()*.4-.2,l=Math.random()*.4-.2;p.rotation.x=P,p.rotation.z=l,console.log(`üé≤ Random tilt: X=${(P*180/Math.PI).toFixed(1)}¬∞, Z=${(l*180/Math.PI).toFixed(1)}¬∞`);const w=280,d=165,o=185,f=2*Math.PI/s,k=2*Math.PI*w,v=k/s,E=v-d;console.log(`üìè Obim: ${k.toFixed(0)}px, Prostor: ${v.toFixed(0)}px, Slika: ${d}px, Razmak: ${E.toFixed(0)}px`),console.log(`üì∏ Kreiram 3D cylinder carousel s ${s} slika (PO REDU iz CMS-a)...`);let M=0;const ee=new Array(s);i.forEach((c,g)=>{T.load(c.src,j=>{const H=new THREE.PlaneGeometry(d,o,64,1),q=new THREE.ShaderMaterial({uniforms:{uTexture:{value:j},uBend:{value:.0015},uOpacity:{value:0}},vertexShader:A,fragmentShader:x,transparent:!0,side:THREE.DoubleSide}),z=new THREE.Mesh(H,q),V=-f*g+Math.PI,Te=Math.sin(V)*w,je=Math.cos(V)*w;z.position.set(Te,30,je),z.rotation.y=V,z.material.uniforms.uOpacity.value=0,z.scale.set(.7,.7,.7),p.add(z),ee[g]=z,M++,console.log(`‚úì Uƒçitana slika ${M}/${s} (index: ${g})`),M===s&&(ee.forEach(Le=>b.push(Le)),console.log("‚úÖ Sve slike uƒçitane PO REDU iz CMS-a!"),be())},void 0,j=>{console.error(`‚ùå Gre≈°ka pri uƒçitavanju slike ${g}:`,j)})});function Se(c){if(c){const g=c.textContent.trim();c.innerHTML=g.split("").map(j=>`<span style="display: inline-block;">${j===" "?"&nbsp;":j}</span>`).join("")}}Se(t);const te=t?t.querySelectorAll("span"):[];gsap.set(r,{y:20,opacity:0}),gsap.set(te,{y:200,opacity:0});function be(){console.log("üé¨ Pokreƒáem jednostavnu animaciju...");const c=gsap.timeline();c.to(te,{y:0,opacity:1,duration:.3,stagger:.03,ease:"power3.out"},0),c.to(r,{y:0,opacity:1,duration:.4,stagger:.1,ease:"power3.out"},.2),xe(.008),console.log("üîÑ Carousel rotacija pokrenuta za reveal!"),b.forEach((H,q)=>{const z=.2+q*.15;c.to(H.material.uniforms.uOpacity,{value:1,duration:.6,ease:"power1.out",onComplete:()=>{console.log(`‚úì Slika ${q+1}/${b.length} se pojavila`)}},z),c.to(H.scale,{x:1,y:1,z:1,duration:.6,ease:"back.out(1.2)"},z)});const g=.2+(b.length-1)*.15+.6,j={value:.008};c.to(j,{value:I,duration:2,ease:"power2.out",onUpdate:()=>{C=j.value},onComplete:()=>{console.log("‚ú® Sve fotke stigle! Default brzina: 0.001 (scroll ga ubrzava 1:1, drag radi!)"),ke()}},g)}function ke(){console.log("üåä Pokreƒáem breathing efekt - carousel se lagano ljulja!");const c=p.rotation.x,g=p.rotation.z;gsap.to(p.rotation,{x:c+.03,duration:4,ease:"sine.inOut",yoyo:!0,repeat:-1}),gsap.to(p.rotation,{z:g+.025,duration:5.5,ease:"sine.inOut",yoyo:!0,repeat:-1})}let I=.001,F=0,C=I,Ee=.015;function xe(c){const g=c;C=g,console.log(`üîÑ Carousel rotacija postavljena na ${g.toFixed(4)} rad/frame`)}let oe=0,ne=0,R=!1,O=0,W=0,U=0,_=!1,B=0;const ie=c=>{R=!0,c.clientX,O=c.clientX,U=c.clientX,W=0,gsap.killTweensOf(p.rotation),B=C,C=0,_=!0,window.dispatchEvent(new CustomEvent("hero:drag:start")),a.domElement.style.cursor="grabbing",console.log("üñ±Ô∏è Drag zapoƒçeo")},ae=c=>{if(!R)return;c.preventDefault(),O=c.clientX;const g=O-U;p.rotation.y+=g*9e-4,W=g*9e-4,U=O},re=()=>{if(!R)return;R=!1,a.domElement.style.cursor="grab",window.dispatchEvent(new CustomEvent("hero:drag:end"));const c=W*80;gsap.to(p.rotation,{y:p.rotation.y+c,duration:3,ease:"power2.out"}),setTimeout(()=>{R||gsap.to({speed:0},{speed:B,duration:1,ease:"power2.inOut",onUpdate:function(){C=this.targets()[0].speed},onComplete:()=>{C=B,_=!1,console.log("üîÑ Automatska rotacija nastavljena")}})},2500),console.log("üñ±Ô∏è Drag zavr≈°io, inertia:",c)};a.domElement.addEventListener("mousedown",ie),window.addEventListener("mousemove",ae),window.addEventListener("mouseup",re),a.domElement.style.cursor="grab",a.domElement.style.userSelect="none",a.domElement.style.webkitUserSelect="none",a.domElement.style.touchAction="auto",console.log("üñ±Ô∏è Mouse drag aktiviran (desktop), touch scroll omoguƒáen (mobitel/tablet)");let N=!0;const X=new IntersectionObserver(c=>{c.forEach(g=>{N=g.isIntersecting,console.log(N?"‚ñ∂Ô∏è Hero sekcija u viewportu - nastavljam rendering":"üõë Hero sekcija izvan viewporta - pauziran rendering")})},{threshold:0,rootMargin:"100px"});X.observe(e);const le=()=>{N&&(F+=(C-F)*.15,p.rotation.y+=F,a.render(y,m))};gsap.ticker.add(le),console.log("‚úÖ Hero rendering integriran sa GSAP ticker-om (sinkroniziran sa Lenis-om)");function se(){const c=u.offsetWidth,g=u.offsetHeight;m.aspect=c/g,m.updateProjectionMatrix(),a.setSize(c,g)}window.addEventListener("resize",se);let G=!1;const Y=()=>{R||_||G||(G=!0,requestAnimationFrame(()=>{const c=window.pageYOffset||document.documentElement.scrollTop,g=Math.abs(c-oe);ne=Math.min(g*8e-4,Ee),g>.5?(gsap.killTweensOf(p.rotation),C=I+ne):C=I,oe=c,G=!1}))};window.removeEventListener("scroll",Y),window.addEventListener("scroll",Y,{passive:!0}),window.addEventListener("barba:before-leave",()=>{console.log("üßπ ƒåistim Three.js resurse..."),gsap.ticker.remove(le),console.log("üõë Hero ticker callback uklonjen"),gsap.killTweensOf(p.rotation),X&&X.disconnect(),a.domElement.removeEventListener("mousedown",ie),window.removeEventListener("mousemove",ae),window.removeEventListener("mouseup",re),b.forEach(c=>{c.geometry&&c.geometry.dispose(),c.material&&(c.material.uniforms.uTexture.value&&c.material.uniforms.uTexture.value.dispose(),c.material.dispose())}),a.dispose(),window.removeEventListener("resize",se),window.removeEventListener("scroll",Y)}),console.log("‚úÖ 3D Cylinder Carousel spreman!")}window.initHero=he;document.querySelector(".hero-images-container")&&he();function Z(){console.log("‚ö†Ô∏è about-section.js PRIVREMENO ISKLJUƒåEN")}window.initAboutSection=Z;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Z):Z();function we(){const e=document.querySelector(".section.highlights"),t=document.querySelector(".highlights-wrapper");if(!e||!t)return;gsap.registerPlugin(ScrollTrigger);const r=t.scrollWidth-e.offsetWidth;gsap.to(t,{x:-r,ease:"none",scrollTrigger:{trigger:e,start:"top top",end:`+=${r}`,scrub:1,pin:!0,anticipatePin:1,invalidateOnRefresh:!0,id:"highlights-horizontal"}});const n=document.querySelectorAll(".highlights-card"),i=window.innerWidth<=767;gsap.set(n,{opacity:0,y:50}),gsap.to(n,{opacity:1,y:0,duration:.6,ease:"power1.inOut",stagger:.2,scrollTrigger:{trigger:".highlights-wrapper",start:"top 80%",toggleActions:"play none none none",id:"highlights-cards"}})}window.initHighlights=we;we();function ve(){const e=document.querySelectorAll(".categories-row");if(!document.querySelector(".section.categories")){console.warn("Element .section.categories nije pronaƒëen na stranici");return}e.forEach(r=>{r.addEventListener("mouseenter",()=>{gsap.to(e,{opacity:.1,duration:.3,ease:"power2.out"}),gsap.to(r,{opacity:1,duration:.3,ease:"power1.out"}),e.forEach(y=>{const m=y.querySelector(".categories-photo");y!==r&&gsap.to(m,{opacity:0,duration:.3,ease:"power2.out"})});const n=r.querySelector(".categories-photo");gsap.to(n,{opacity:1,height:300,duration:.3,ease:"power1.out"});const i=r.querySelector(".cta");gsap.to(i,{opacity:1,duration:.3,ease:"power1.out"});const s=r.querySelector(".title-l"),u=r.querySelector(".cta");s&&createShuffleEffect(s,!1)(),u&&createShuffleEffect(u,!1)()}),r.addEventListener("mouseleave",()=>{gsap.to(e,{opacity:1,duration:.3,ease:"power1.out"}),e.forEach(i=>{const s=i.querySelector(".categories-photo");gsap.to(s,{opacity:0,height:0,duration:.3,ease:"power1.out"})});const n=r.querySelector(".cta");gsap.to(n,{opacity:0,duration:.3,ease:"power1.out"})})})}window.initCategories=ve;ve();let D=!1;function K(){if(console.log("üîç initWork() POZVAN!"),D){console.log("‚ö†Ô∏è initWork() veƒá se izvr≈°ava, preskaƒçem");return}D=!0;const e=document.querySelectorAll(".photo-container");if(console.log("üîç Pronaƒëeno photo containers:",e.length),!e.length){console.log("‚ö†Ô∏è Nema photo containers - nije work page, izlazim"),D=!1;return}console.log("‚úÖ Inicijaliziram Work page grid!");try{let m=function(){const a=window.innerWidth;return a<768?y.mobile:a<992?y.tablet:y.desktop},h=function(){const a=m();let S=!0,L=1,A=null,x=null;window.shuffledPhotos.forEach(T=>{const b=T.querySelector(".photo"),P=b.naturalWidth>b.naturalHeight?a.horizontalSpan:a.verticalSpan;let l;if(a.columns===1)l=1;else if(S){do l=a.left[Math.floor(Math.random()*a.left.length)];while(l===A);A=l}else{do l=a.right[Math.floor(Math.random()*a.right.length)];while(l===x);x=l}T.style.gridColumnStart=l,T.style.gridColumnEnd=l+P,T.style.gridRowStart=L,S=!S,L++})};var t=m,r=h;document.querySelectorAll(".photo").forEach(a=>{a.originalParent=a.parentElement});const i=30,s=Array.from(document.querySelectorAll(".photo-container"));console.log("üîç Ukupno photo containers:",s.length),s.forEach(a=>{const S=a.querySelector(".photo");S&&(S.setAttribute("loading","lazy"),S.setAttribute("decoding","async"))}),s.forEach(a=>{a.style.display="",a.style.gridColumn="",a.style.gridColumnStart="",a.style.gridColumnEnd="",a.style.gridRowStart="",a.style.transform=""}),console.log("‚úÖ Reset svih photo containers");const u=s.slice(0,i);s.slice(i).forEach(a=>{a.style.display="none"}),console.log(`üì∏ Prikazujem prvih ${i} fotki, sakrivam ${s.length-i}`),(!window.shuffledPhotos||window.location.pathname!==window.lastPath)&&(window.shuffledPhotos=u.sort(()=>Math.random()-.5),window.lastPath=window.location.pathname);const y={desktop:{columns:12,left:[2,3],right:[8,9],horizontalSpan:3,verticalSpan:2},tablet:{columns:8,left:[2,3],right:[5,6],horizontalSpan:3,verticalSpan:2},mobile:{columns:1,left:[1],right:[1],horizontalSpan:1,verticalSpan:1}};window.isSettingUpGrid||(window.isSettingUpGrid=!0,h(),window.isSettingUpGrid=!1),gsap.fromTo(window.shuffledPhotos,{opacity:0,scale:.8,y:window.innerHeight/5},{opacity:1,scale:1,y:0,duration:.8,ease:"power3.out",stagger:.1}),console.log("‚úÖ Grid postavljen.")}finally{D=!1}}function J(){const e=document.querySelectorAll(".work-categories-title-wrapper, .work-categories-top-margin");e&&gsap.matchMedia().add("(max-width: 767px)",()=>{gsap.to(e,{scale:.7,opacity:0,scrollTrigger:{trigger:e,start:"top top",end:"+=200",scrub:.5,invalidateOnRefresh:!0}})})}window.initWork=K;window.initCategoryTitleAnimation=J;console.log("üì¶ work.js loaded, document.readyState:",document.readyState);document.readyState==="loading"?(console.log("‚è≥ ƒåekam DOMContentLoaded za work page..."),document.addEventListener("DOMContentLoaded",()=>{K(),J()})):(console.log("‚ñ∂Ô∏è DOM veƒá loaded, pozivam initWork() i initCategoryTitleAnimation() odmah"),K(),J());function ye(){const e=document.querySelector(".modal-photo");if(!e)return;const t=e.querySelector(".modal-photo-container"),r=e.querySelector(".modal-title"),n=e.querySelector(".modal-exif"),i=e.querySelector(".modal-close"),s=e.querySelector('[data-photo-nav="previous"]'),u=e.querySelector('[data-photo-nav="next"]'),y=document.querySelectorAll(".photo");gsap.registerPlugin(Flip);let m=0,h=[],a=null;function S(l){const d=l.getBoundingClientRect(),o=window.scrollY||document.documentElement.scrollTop,f=d.top+o-100;window.scrollTo({top:f,behavior:"auto"})}y.forEach((l,w)=>{const d=window.shuffledPhotos.find(f=>f.querySelector(".photo")===l),o=window.shuffledPhotos.indexOf(d);h[o]={src:l.getAttribute("src"),title:l.getAttribute("data-title"),exif:l.getAttribute("data-exif"),category:l.getAttribute("data-category"),element:l,placeholder:null},l.addEventListener("click",()=>{m=o,a=l,L(h[m])})});function L(l){window.lenis&&window.lenis.stop(),document.body.style.overflow="hidden";const w=Flip.getState(l.element,{props:"all"}),d=l.element.originalParent,o=document.createElement("div");o.classList.add("photo-placeholder"),o.style.width=l.element.offsetWidth+"px",o.style.height=l.element.offsetHeight+"px",d.insertBefore(o,l.element),l.placeholder=o;const f=Array.from(document.querySelectorAll(".photo, .navigation, .navbar, .work-categories-wrapper, .category-title")).filter(k=>k!==l.element);gsap.to(f,{opacity:0,duration:.3,ease:"power2.inOut"}),t.appendChild(l.element),gsap.set(l.element,{opacity:1}),e.style.display="grid",e.classList.add("active"),e.style.backgroundColor="transparent",r.textContent=l.title,n.textContent=l.exif,gsap.set([r,n,i,s,u],{opacity:0,y:20}),Flip.from(w,{duration:.8,ease:"power2.inOut",absolute:!0,onComplete:()=>{e.classList.contains("active")&&gsap.to(e,{backgroundColor:"var(--_colors---off-white)",duration:.4,ease:"power2.out"}),gsap.to([r,n,i,s,u],{opacity:1,y:0,duration:.4,stagger:.1,ease:"power2.out"})}})}function A(){if(!a)return;window.lenis&&window.lenis.start(),document.body.style.overflow="";const l=h[m],w=l.element,d=document.querySelectorAll(".photo, .navigation, .navbar, .work-categories-wrapper, .category-title");gsap.set(e,{backgroundColor:"transparent"}),gsap.to([r,n,i,s,u],{opacity:0,y:20,duration:.3,ease:"power2.in"});const o=w.originalParent,f=o.getBoundingClientRect(),k=window.scrollY||document.documentElement.scrollTop,v=f.top+k-window.innerHeight/2+f.height/2;window.scrollTo({top:v,behavior:"auto"});const E=Flip.getState(w,{props:"all"});l.placeholder&&o&&(o.insertBefore(w,l.placeholder),l.placeholder.remove(),l.placeholder=null),Flip.from(E,{duration:.8,ease:"power2.inOut",onUpdate:function(){this.progress()>.7&&gsap.to(d,{opacity:1,duration:.3,ease:"power2.out"})},onComplete:()=>{e.classList.remove("active"),e.style.display="none",a=null}})}function x(){const l=document.querySelectorAll(".photo");gsap.killTweensOf(l);let w=m<h.length-1?m+1:0;const d=h[m],o=h[w];d.placeholder&&d.element.originalParent&&(gsap.set(d.element,{x:0,opacity:1,scale:1,rotation:0}),d.element.originalParent.insertBefore(d.element,d.placeholder),d.placeholder.remove(),d.placeholder=null);const f=Array.from(document.querySelectorAll(".photo")).filter(E=>E!==o.element);gsap.set(f,{opacity:0});const k=o.element.originalParent,v=document.createElement("div");v.classList.add("photo-placeholder"),v.style.width=o.element.offsetWidth+"px",v.style.height=o.element.offsetHeight+"px",k.insertBefore(v,o.element),o.placeholder=v,S(o.element),t.innerHTML="",t.appendChild(o.element),gsap.set(o.element,{opacity:1,x:"100%",scale:.95,rotation:3}),gsap.to(o.element,{x:0,scale:1,rotation:0,duration:.5,ease:"power2.out"}),r.textContent=o.title,n.textContent=o.exif,a=o.element,m=w}function T(){const l=document.querySelectorAll(".photo");gsap.killTweensOf(l);let w=m>0?m-1:h.length-1;const d=h[m],o=h[w];d.placeholder&&d.element.originalParent&&(gsap.set(d.element,{x:0,opacity:1,scale:1,rotation:0}),d.element.originalParent.insertBefore(d.element,d.placeholder),d.placeholder.remove(),d.placeholder=null);const f=Array.from(document.querySelectorAll(".photo")).filter(E=>E!==o.element);gsap.set(f,{opacity:0});const k=o.element.originalParent,v=document.createElement("div");v.classList.add("photo-placeholder"),v.style.width=o.element.offsetWidth+"px",v.style.height=o.element.offsetHeight+"px",k.insertBefore(v,o.element),o.placeholder=v,S(o.element),t.innerHTML="",t.appendChild(o.element),gsap.set(o.element,{opacity:1,x:"-100%",scale:.95,rotation:-3}),gsap.to(o.element,{x:0,scale:1,rotation:0,duration:.5,ease:"power2.out"}),r.textContent=o.title,n.textContent=o.exif,a=o.element,m=w}document.addEventListener("keydown",l=>{e.classList.contains("active")&&(l.key==="Escape"&&A(),l.key==="ArrowRight"&&x(),l.key==="ArrowLeft"&&T())}),e.addEventListener("click",l=>{l.target===e&&A()}),i.addEventListener("click",A),s.addEventListener("click",T),u.addEventListener("click",x);const b=new Hammer(t);b.get("pan").set({direction:Hammer.DIRECTION_HORIZONTAL});let p=!1,P=0;b.on("panstart",function(l){p=!0,P=l.center.x,gsap.killTweensOf(a)}),b.on("pan",function(l){if(!p||!a)return;const d=(l.center.x-P)/window.innerWidth*100,f=Math.min(Math.max(d*.5,-50),50),k=Math.abs(f),v=gsap.utils.mapRange(0,50,1,.3)(k),E=gsap.utils.mapRange(0,50,1,0)(k);gsap.set(a,{x:f+"%",rotation:f*.05,scale:v,opacity:E})}),b.on("panend",function(l){if(!p||!a)return;p=!1;const w=Math.abs(l.velocity),d=l.deltaX,o=window.innerWidth*.2;Math.abs(d)>o||w>.5?d<0?x():T():gsap.to(a,{x:"0%",rotation:0,scale:1,opacity:1,duration:.3,ease:"power2.out"})})}window.initPhotoModal=ye;ye();function Q(){console.log("üîç initAbout() POZVAN!"),console.log("üîç document.readyState:",document.readyState),console.log("üîç Tra≈æim .section.about-page...");const e=document.querySelector(".section.about-page");if(console.log("üîç .section.about-page pronaƒëen?",!!e),!e){console.log("‚ö†Ô∏è .section.about-page NE POSTOJI - izlazim iz initAbout()");return}console.log("‚úÖ üé® Inicijaliziram About Page animacije!"),gsap.registerPlugin(ScrollTrigger);const t=document.createElement("style");t.textContent=`
    .about-page-title {
      overflow: visible;
    }
    
    .about-page-title .line {
      display: block;
      opacity: 0;
    }
  `,document.head.appendChild(t);const r=document.querySelector(".about-page-mobile-img"),n=document.querySelector(".about-page-title");document.querySelector(".about-page-paragraph");const i=document.querySelector("#w-node-_5cfb6280-6a33-c948-6914-d1d14a02033e-e0820647"),s=document.querySelector("#w-node-_8ff28dca-4908-092a-a93e-64674276b761-e0820647"),u=document.querySelector("#w-node-d37b0f9a-3049-7721-1f0b-b2dfa6b25604-e0820647"),y=document.querySelector("#w-node-a792f731-c023-e6a4-a3a2-3b0f75706c28-e0820647"),m=document.querySelector("#w-node-_38752304-f930-7aec-55b4-e5bb69d7261b-e0820647"),h=document.querySelector("#w-node-af8686f0-0eff-8a7c-0ed7-beca4d3b4ae5-e0820647"),a=document.querySelector("#w-node-f5866f73-1277-b3c6-9637-905ed2896c1d-e0820647"),S=document.querySelector("#w-node-_26bcf290-3970-d3ae-4c5a-8a87562b3b8f-e0820647"),L=document.querySelector("#w-node-_959dd736-48e6-8ca1-a499-ecdb1597fdfc-e0820647"),A=document.querySelector("#w-node-_81d87156-36a4-f557-ac99-5a50eaa2aede-e0820647"),x=document.querySelectorAll(".divider"),T=[],b=gsap.timeline();r&&(gsap.set(r,{clipPath:"inset(0% 0% 100% 0%)"}),b.to(r,{clipPath:"inset(0% 0% 0% 0%)",duration:1.2,ease:"expo.inOut"},.2));let p=0,P=.8,l=0;if(n){const o=new SplitType(n,{types:"lines"});if(T.push(o),o.lines&&o.lines.length>0){const f=o.lines;gsap.set(f,{opacity:0,y:20}),f.forEach((v,E)=>{b.to(v,{opacity:1,y:0,duration:.4,ease:"power2.out"},P+E*.15)}),p=P+(f.length-1)*.15+.4;const k=p-P;l=P+k*.7-.15,b.call(()=>{},null,p)}}const w=[{divider:x[0],title:i,content:m},{divider:x[1],title:s,content:h},{divider:x[2],title:u,content:a},{divider:x[3],title:y,content:S},{divider:x[4],title:L,content:A}];let d=l;w.forEach((o,f)=>{if(!o.divider)return;if(gsap.set(o.divider,{width:0,opacity:0}),o.title&&gsap.set(o.title,{opacity:0,y:20}),o.content&&gsap.set(o.content,{opacity:0,y:20}),o.divider.getBoundingClientRect().top<window.innerHeight){b.to(o.divider,{opacity:1,width:"100%",duration:.6,ease:"power2.inOut"},d),o.title&&b.to(o.title,{opacity:1,y:0,duration:.6,ease:"power2.out"},d+.15),o.content&&b.to(o.content,{opacity:1,y:0,duration:.6,ease:"power2.out"},d+.25);const M=d+.25+.6-d;d=d+M*.7}else ScrollTrigger.create({trigger:o.divider,start:"top 92%",once:!0,onEnter:()=>{const E=gsap.timeline();E.to(o.divider,{opacity:1,width:"100%",duration:.6,ease:"power2.inOut"},0),o.title&&E.to(o.title,{opacity:1,y:0,duration:.6,ease:"power2.out"},.15),o.content&&E.to(o.content,{opacity:1,y:0,duration:.6,ease:"power2.out"},.25)}})}),typeof barba<"u"&&barba.hooks.beforeLeave(()=>{T.forEach(o=>{o&&o.revert&&o.revert()}),ScrollTrigger.getAll().forEach(o=>o.kill()),t&&t.parentNode&&t.parentNode.removeChild(t)})}window.initAbout=Q;console.log("üì¶ about-page.js loaded, document.readyState:",document.readyState);document.readyState==="loading"?(console.log("‚è≥ ƒåekam DOMContentLoaded..."),document.addEventListener("DOMContentLoaded",Q)):(console.log("‚ñ∂Ô∏è DOM veƒá loaded, pozivam initAbout() odmah"),Q());Re();
